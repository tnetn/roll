<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ß—Ç–æ –æ—Ç–≤–∞–ª–∏—Ç—Å—è —Å–µ–≥–æ–¥–Ω—è?</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    min-height: 100vh;
    background: linear-gradient(135deg, #003d82 0%, #002855 50%, #001a3d 100%);
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    color: #fff;
    padding: 20px;
    overflow-x: hidden;
}

.container {
    width: 100%;
    max-width: 1000px;
    text-align: center;
}

h1 {
    font-size: clamp(28px, 5vw, 48px);
    font-weight: 700;
    margin-bottom: clamp(30px, 5vh, 50px);
    color: #ffffff;
    letter-spacing: 0.5px;
}

.roulette-wrapper {
    position: relative;
    margin-bottom: clamp(30px, 5vh, 40px);
}

.arrow {
    position: absolute;
    top: -35px;
    left: 50%;
    transform: translateX(-50%);
    font-size: clamp(40px, 6vw, 56px);
    z-index: 10;
    color: #e30613;
    filter: drop-shadow(0 4px 12px rgba(227, 6, 19, 0.6));
    pointer-events: none;
}

.roulette {
    overflow: hidden;
    height: clamp(200px, 30vh, 280px);
    border-radius: clamp(20px, 3vw, 32px);
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(20px);
    box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
}

.track {
    display: flex;
    align-items: center;
    height: 100%;
    will-change: transform;
    padding: 0 10px;
}

.item {
    min-width: clamp(140px, 20vw, 200px);
    height: clamp(160px, 25vh, 220px);
    margin: 0 clamp(8px, 1.5vw, 15px);
    background: linear-gradient(145deg, rgba(30, 30, 60, 0.8), rgba(20, 20, 40, 0.9));
    border-radius: clamp(18px, 2.5vw, 28px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: clamp(15px, 2vw, 25px);
    transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.05);
    position: relative;
    overflow: hidden;
}

.item::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(0, 102, 204, 0) 0%, rgba(0, 102, 204, 0.1) 100%);
    opacity: 0;
    transition: opacity 0.5s ease;
}

.item:hover::before {
    opacity: 1;
}

.item img {
    width: clamp(70px, 12vw, 110px);
    height: clamp(70px, 12vw, 110px);
    object-fit: contain;
    margin-bottom: clamp(10px, 2vh, 15px);
    filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));
    transition: transform 0.3s ease;
}

.item:hover img {
    transform: scale(1.1) rotate(5deg);
}

.item span {
    font-size: clamp(14px, 2vw, 18px);
    font-weight: 700;
    opacity: 0.95;
    text-align: center;
    letter-spacing: 0.5px;
    text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
}

.item.active {
    transform: scale(1.15);
    background: linear-gradient(145deg, #0066cc, #e30613);
    box-shadow: 
        0 0 60px rgba(0, 102, 204, 0.8),
        0 0 120px rgba(227, 6, 19, 0.5),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
    animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% { box-shadow: 0 0 60px rgba(0, 102, 204, 0.8), 0 0 120px rgba(227, 6, 19, 0.5); }
    50% { box-shadow: 0 0 80px rgba(0, 102, 204, 1), 0 0 160px rgba(227, 6, 19, 0.7); }
}

button {
    padding: clamp(16px, 2.5vh, 22px) clamp(50px, 8vw, 70px);
    font-size: clamp(18px, 2.5vw, 24px);
    font-weight: 600;
    border: 2px solid #0066cc;
    border-radius: clamp(8px, 1.5vw, 12px);
    background: #0066cc;
    color: #fff;
    cursor: pointer;
    transition: all 0.3s ease;
    letter-spacing: 0.5px;
    text-transform: uppercase;
}

button::before {
    display: none;
}

button:hover {
    background: #0052a3;
    border-color: #0052a3;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 102, 204, 0.3);
}

button:active {
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(0, 102, 204, 0.2);
}

button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

.modal {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(12px);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s ease;
    z-index: 1000;
    padding: 20px;
}

.modal.show {
    opacity: 1;
    pointer-events: auto;
}

.modal-content {
    display: flex;
    flex-wrap: wrap;
    gap: clamp(20px, 3vw, 40px);
    justify-content: center;
    max-width: 90vw;
    margin-bottom: clamp(30px, 5vh, 40px);
}

.modal .item {
    background: transparent;
    border: none;
    box-shadow: none;
    transform: scale(1.2);
    animation: itemPop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.modal .item::before {
    display: none;
}

.modal .item:nth-child(1) { animation-delay: 0.1s; }
.modal .item:nth-child(2) { animation-delay: 0.2s; }
.modal .item:nth-child(3) { animation-delay: 0.3s; }

.close-btn {
    background: linear-gradient(145deg, rgba(30, 30, 60, 0.95), rgba(20, 20, 40, 0.98));
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: clamp(12px, 2vw, 16px);
    padding: clamp(12px, 2vh, 18px) clamp(40px, 6vw, 60px);
    font-size: clamp(20px, 3vw, 28px);
    color: #fff;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 12px;
    transition: all 0.3s ease;
    animation: btnPop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.4s both;
    box-shadow: 
        0 8px 24px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.close-btn:hover {
    transform: translateY(-2px);
    box-shadow: 
        0 12px 32px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
    border-color: rgba(255, 255, 255, 0.2);
}

.close-btn:active {
    transform: translateY(0);
}

@keyframes itemPop {
    0% { 
        transform: scale(0) rotate(-180deg); 
        opacity: 0;
    }
    100% { 
        transform: scale(1.2) rotate(0deg); 
        opacity: 1;
    }
}

@keyframes btnPop {
    from { 
        transform: scale(0.5); 
        opacity: 0; 
    }
    to { 
        transform: scale(1); 
        opacity: 1; 
    }
}

/* –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è */
@media (max-width: 768px) {
    .roulette {
        height: clamp(180px, 28vh, 240px);
    }
    
    .item {
        min-width: clamp(120px, 25vw, 160px);
        height: clamp(140px, 22vh, 180px);
    }
    
    .modal-content {
        flex-direction: column;
        align-items: center;
    }
    
    .track {
        padding: 0 5px;
    }
}

@media (max-width: 480px) {
    body {
        padding: 15px;
    }
    
    .item {
        min-width: 110px;
        height: 130px;
        margin: 0 6px;
    }
    
    .item img {
        width: 60px;
        height: 60px;
    }
    
    .modal .item {
        transform: scale(1.1);
    }
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}
</style>
</head>
<body>
<div class="container">
    <h1>–ß—Ç–æ –æ—Ç–≤–∞–ª–∏—Ç—Å—è —Å–µ–≥–æ–¥–Ω—è?</h1>
    <div class="roulette-wrapper">
        <div class="arrow">‚ñº</div>
        <div class="roulette" id="roulette">
            <div class="track" id="track">
                <div class="item"><img src="https://w7.pngwing.com/pngs/986/441/png-transparent-cryptocurrency-cardano-computer-icons-primecoin-augur-crypto-coin-aqua-privacy-policy-privacy.png" alt="–ë–∏–ª–ª–∏–Ω–≥"><span>–ë–ò–õ–õ–ò–ù–ì</span></div>
                <div class="item"><img src="https://avatars.mds.yandex.net/i?id=ebe07207e363d99ab80425d983b53975_l-5287693-images-thumbs&n=13" alt="–°–≠–î"><span>–°–≠–î</span></div>
                <div class="item"><img src="https://sistemnik.pro/wp-content/uploads/2024/03/08917643-ba1b-4bad-b031-4006f8fb7d84-1-768x768.webp" alt="1–°"><span>1–°</span></div>
                <div class="item"><img src="https://avatars.mds.yandex.net/i?id=ebe07207e363d99ab80425d983b53975_l-5287693-images-thumbs&n=13" alt="–ö–ò–° –≠–•–î"><span>–ö–ò–° –≠–•–î</span></div>
                <div class="item"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Verein_Deutscher_Ingenieure%2C_Logo.svg/1200px-Verein_Deutscher_Ingenieure%2C_Logo.svg.png" alt="VDI"><span>VDI</span></div>
                <div class="item"><img src="https://static.tildacdn.com/tild3462-3938-4363-b861-616464393535/IVA_Mobile_.png" alt="IVA"><span>IVA</span></div>
            </div>
        </div>
    </div>
    <button id="spinBtn">–£–∑–Ω–∞—Ç—å</button>
</div>

<div class="modal" id="modal">
    <div class="modal-content" id="modalContent"></div>
    <button class="close-btn" id="closeBtn">
        <span>üò¢</span>
        <span>–û—Ö!</span>
    </button>
</div>

<script>
const track = document.getElementById('track');
const roulette = document.getElementById('roulette');
const btn = document.getElementById('spinBtn');
const modal = document.getElementById('modal');
const modalContent = document.getElementById('modalContent');
const closeBtn = document.getElementById('closeBtn');

// –ë–∞–∑–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ)
const baseItems = Array.from(track.children);
const baseCount = baseItems.length;

// –°–æ–∑–¥–∞—ë–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–æ–ø–∏–π –¥–ª—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
const COPIES = 20;
track.innerHTML = track.innerHTML.repeat(COPIES);
const allItems = Array.from(track.children);

let itemWidth = 0;
let rouletteCenter = 0;
let spinning = false;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Ä–∞—Å—á—ë—Ç —Ä–∞–∑–º–µ—Ä–æ–≤
function init() {
    const firstItem = allItems[0];
    const style = window.getComputedStyle(firstItem);
    
    // –ü–æ–ª–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤–∫–ª—é—á–∞—è margin
    itemWidth = firstItem.offsetWidth + 
                parseFloat(style.marginLeft) + 
                parseFloat(style.marginRight);
    
    // –¶–µ–Ω—Ç—Ä —Ä—É–ª–µ—Ç–∫–∏
    rouletteCenter = roulette.offsetWidth / 2;
    
    // –°—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è - —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Å—Ä–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å—Ä–µ–¥–Ω–µ–π –∫–æ–ø–∏–∏
    const middleCopy = Math.floor(COPIES / 2);
    const middleItem = Math.floor(baseCount / 2);
    const startIndex = middleCopy * baseCount + middleItem;
    
    resetPosition(startIndex);
}

// –°–±—Ä–æ—Å –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏
function resetPosition(index) {
    track.style.transition = 'none';
    const offset = index * itemWidth - rouletteCenter + (itemWidth / 2);
    track.style.transform = `translateX(${-offset}px)`;
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π reflow –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
    track.offsetHeight;
}

// –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ–¥ —Å—Ç—Ä–µ–ª–∫–æ–π –ø–æ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏ —Ç—Ä–µ–∫–∞
function getItemUnderArrow() {
    const currentTransform = track.style.transform;
    const currentMatch = currentTransform.match(/translateX\((-?\d+\.?\d*)px\)/);
    const currentOffset = currentMatch ? parseFloat(currentMatch[1]) : 0;
    
    // –í—ã—á–∏—Å–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é —Ü–µ–Ω—Ç—Ä–∞ —Ä—É–ª–µ—Ç–∫–∏
    const centerPosition = Math.abs(currentOffset);
    const centerIndex = Math.round(centerPosition / itemWidth);
    
    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤ –±–∞–∑–æ–≤–æ–º –º–∞—Å—Å–∏–≤–µ
    return centerIndex % baseCount;
}

// –û–¥–∏–Ω —Å–ø–∏–Ω
function doSpin(usedIndices) {
    return new Promise((resolve) => {
        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å
        allItems.forEach(item => item.classList.remove('active'));
        
        // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç, –∏—Å–∫–ª—é—á–∞—è —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ
        const availableIndices = Array.from({length: baseCount}, (_, i) => i)
            .filter(i => !usedIndices.includes(i));
        const targetBaseIndex = availableIndices[Math.floor(Math.random() * availableIndices.length)];
        
        // –ú–∏–Ω–∏–º—É–º 3 –ø–æ–ª–Ω—ã—Ö –∫—Ä—É–≥–∞ + —Å–ª—É—á–∞–π–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã (–∏—Ç–æ–≥–æ 3-5 –∫—Ä—É–≥–æ–≤)
        const minSpins = 3;
        const extraSpins = Math.floor(Math.random() * 3);
        const fullSpins = minSpins + extraSpins;
        
        // –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è —Ç—Ä–µ–∫–∞
        const currentTransform = track.style.transform;
        const currentMatch = currentTransform.match(/translateX\((-?\d+\.?\d*)px\)/);
        const currentOffset = currentMatch ? parseFloat(currentMatch[1]) : 0;
        
        // –í—ã—á–∏—Å–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å
        const currentPosition = Math.abs(currentOffset);
        const currentIndex = Math.round(currentPosition / itemWidth);
        
        // –¶–µ–ª–µ–≤–æ–π –∏–Ω–¥–µ–∫—Å - –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã –∏ —Ü–µ–ª–µ–≤—É—é –ø–æ–∑–∏—Ü–∏—é
        const targetIndex = currentIndex + (fullSpins * baseCount) + targetBaseIndex;
        
        // –¢–æ—á–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ–¥ —Å—Ç—Ä–µ–ª–∫–æ–π
        const exactOffset = targetIndex * itemWidth - rouletteCenter + (itemWidth / 2);
        
        // –°–ª—É—á–∞–π–Ω–æ–µ –Ω–µ–¥–æ–∫—Ä—É—á–∏–≤–∞–Ω–∏–µ (20-30% —à–∏—Ä–∏–Ω—ã —ç–ª–µ–º–µ–Ω—Ç–∞)
        const randomUndershoot = itemWidth * (0.2 + Math.random() * 0.1);
        const offsetWithUndershoot = exactOffset - randomUndershoot;
        
        // –û—Å–Ω–æ–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –ù–ï –¥–æ–µ–∑–∂–∞—è
        track.style.transition = 'transform 4.5s cubic-bezier(0.17, 0.67, 0.12, 0.99)';
        track.style.transform = `translateX(${-offsetWithUndershoot}px)`;
        
        setTimeout(() => {
            // –ë—ã—Å—Ç—Ä–∞—è –¥–æ–∫—Ä—É—Ç–∫–∞ –¥–æ —Ç–æ—á–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞
            track.style.transition = 'transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)';
            track.style.transform = `translateX(${-exactOffset}px)`;
            
            setTimeout(() => {
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ–¥ —Å—Ç—Ä–µ–ª–∫–æ–π
                allItems[targetIndex].classList.add('active');
                
                // –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–º–µ—â–∞–µ–º—Å—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω—É—é –∑–æ–Ω—É
                setTimeout(() => {
                    // –ü–µ—Ä–µ–Ω–æ—Å–∏–º –≤ —Å—Ä–µ–¥–Ω—é—é –∫–æ–ø–∏—é –¥–ª—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏
                    const middleCopy = Math.floor(COPIES / 2);
                    const safeIndex = middleCopy * baseCount + targetBaseIndex;
                    
                    allItems[targetIndex].classList.remove('active');
                    resetPosition(safeIndex);
                    allItems[safeIndex].classList.add('active');
                    
                    // –ü–∞—É–∑–∞ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º —Å–ø–∏–Ω–æ–º
                    setTimeout(() => resolve(targetBaseIndex), 600);
                }, 100);
            }, 300);
        }, 4500);
    });
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏
btn.onclick = async () => {
    if (spinning) return;
    
    spinning = true;
    btn.disabled = true;
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–∞–≤—à–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    const roll = Math.random();
    let count = 1;
    if (roll < 0.01) count = 3;      // 1% - —Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞
    else if (roll < 0.11) count = 2; // 10% - –¥–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
    
    const selectedIndices = [];
    
    // –í—ã–ø–æ–ª–Ω—è–µ–º —Å–ø–∏–Ω—ã
    for (let i = 0; i < count; i++) {
        const baseIndex = await doSpin(selectedIndices);
        selectedIndices.push(baseIndex);
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    openModal(selectedIndices);
    
    spinning = false;
    btn.disabled = false;
};

// –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function openModal(selectedIndices) {
    modalContent.innerHTML = '';
    selectedIndices.forEach(idx => {
        const clone = baseItems[idx].cloneNode(true);
        clone.classList.remove('active');
        modalContent.appendChild(clone);
    });
    modal.classList.add('show');
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–æ –∫–Ω–æ–ø–∫–µ
closeBtn.onclick = () => {
    modal.classList.remove('show');
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞
window.addEventListener('load', init);
window.addEventListener('resize', init);
</script>
</body>
</html>
